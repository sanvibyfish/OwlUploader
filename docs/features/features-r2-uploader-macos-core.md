# 需求文档 - macOS R2 Uploader (核心功能)

## 1. 项目背景与目标

OwlUploader 是一款 macOS 桌面应用程序，旨在为用户提供一个简洁、易用的图形界面，用于管理存储在 Cloudflare R2（或其他 S3 兼容服务）上的文件。本期核心目标是实现文件列表的查看与导航、文件的上传以及文件夹的创建功能。

## 2. 用户画像

- 需要频繁与 R2 或其他 S3 兼容对象存储进行文件交互的技术用户或开发者。
- 希望通过图形界面替代命令行工具进行基本文件管理的用户。

## 3. 核心功能需求

### 3.1. FR-001: R2 账户配置与连接
- **描述**: 用户能够配置并安全存储至少一个 R2 账户的连接凭证，应用能够使用这些凭证连接到 R2 服务。
- **用户故事**:
    - 作为用户，我希望能输入我的 R2 Account ID, Access Key ID, Secret Access Key 和 Endpoint URL，以便应用可以连接到我的 R2 存储。
    - 作为用户，我希望我的敏感凭证（如 Secret Access Key）能够被安全地存储。
- **验收标准**:
    - [ ] 用户可以找到输入账户凭证的界面。
    - [ ] 应用能使用提供的凭证成功连接到 R2 服务。
    - [ ] Secret Access Key 存储在系统的 Keychain 中。
    - [ ] Endpoint URL 如果用户不指定，可以提供一个 Cloudflare R2 的默认建议值。

### 3.2. FR-002: 存储桶列表与选择
- **描述**: 用户在成功配置账户后，能够看到其账户下的存储桶列表，并选择一个进行操作。
- **用户故事**:
    - 作为用户，我希望在连接成功后，能看到我账户下所有的存储桶名称。
    - 作为用户，我希望能从列表中选择一个存储桶，后续的文件操作将针对这个选定的存储桶。
- **验收标准**:
    - [ ] 成功连接账户后，应用界面会展示存储桶列表。
    - [ ] 用户可以通过点击选择一个存储桶。
    - [ ] 应用状态清晰指示当前操作的是哪个存储桶。

### 3.3. FR-003: 文件与文件夹列表展示与导航
- **描述**: 用户能够浏览选定存储桶中当前路径下的文件和文件夹列表，并能在文件夹间导航。
- **用户故事**:
    - 作为用户，当我选择一个存储桶后，我希望能看到其根目录下的文件和文件夹列表。
    - 作为用户，我希望能看到每个条目的名称、类型（文件/文件夹的区分图标）、大小（文件）、最后修改日期。
    - 作为用户，我希望能双击文件夹进入该文件夹，并看到其内容。
    - 作为用户，我希望能有方式返回上一级文件夹或直接导航到指定路径（如面包屑导航）。
    - 作为用户，我希望能手动刷新当前的文件列表。
- **验收标准**:
    - [ ] 文件列表能正确显示文件名、大小（文件）、最后修改日期、类型图标。
    - [ ] 双击文件夹能进入该文件夹并更新列表。
    - [ ] 应用提供返回上一级的功能。
    - [ ] （可选）提供面包屑导航显示当前路径。
    - [ ] 刷新按钮能重新加载当前路径下的文件列表。
    - [ ] 对于空文件夹，列表显示为空状态或提示。
    - [ ] 正确处理包含特殊字符（S3允许范围内）的文件/文件夹名。

### 3.4. FR-004: 文件上传至当前路径
- **描述**: 用户能够选择本地文件并将其上传到文件列表中当前显示的 R2 路径下。
- **用户故事**:
    - 作为用户，我希望能有一个"上传文件"的按钮或操作。
    - 作为用户，点击上传后，我能通过系统的文件选择器选择一个或多个本地文件。
    - 作为用户，我希望选中的文件能被上传到我当前在文件列表中浏览的那个文件夹（或存储桶根目录）。
    - 作为用户，我希望能看到上传过程的基本状态指示（如：进行中、成功、失败）。
- **验收标准**:
    - [ ] 应用提供清晰的上传入口。
    - [ ] 用户可以通过系统对话框选择文件。
    - [ ] 文件成功上传到正确的 R2 路径下。
    - [ ] 上传完成后，文件列表会自动刷新或提示用户刷新以看到新文件。
    - [ ] 对上传失败（如网络问题、权限不足）有明确的错误提示。
    - [ ] （可选）支持拖拽文件到列表进行上传。

### 3.5. FR-005: 创建文件夹于当前路径
- **描述**: 用户能够在文件列表中当前显示的 R2 路径下创建新的文件夹。
- **用户故事**:
    - 作为用户，我希望能有一个"创建文件夹"的按钮或操作。
    - 作为用户，点击后我能输入新文件夹的名称。
    - 作为用户，我希望新文件夹能被创建在我当前浏览的那个文件夹（或存储桶根目录）下。
- **验收标准**:
    - [ ] 应用提供清晰的创建文件夹入口。
    - [ ] 用户可以输入文件夹名称。
    - [ ] 文件夹成功创建在正确的 R2 路径下。
    - [ ] 创建成功后，文件列表会自动刷新或提示用户刷新以看到新文件夹。
    - [ ] 对无效的文件夹名称（如包含S3/R2禁止的字符）或创建失败有明确提示。
    - [ ] 创建的文件夹在列表中正确显示为文件夹类型。

## 4. 非功能性需求 (初步)

- **NFR-001 (安全)**: 用户凭证必须安全存储（使用 Keychain）。所有与 R2 的通信必须通过 HTTPS。
- **NFR-002 (性能)**: UI 响应应保持流畅，网络操作不能阻塞主线程。文件列表加载对于中等数量（如几百个）的对象应在合理时间内完成。
- **NFR-003 (易用性)**: 界面简洁直观，核心操作易于发现和使用。错误提示清晰易懂。
- **NFR-004 (稳定性)**: 应用应能妥善处理常见的网络错误和 API 错误，避免意外崩溃。

## 5. 未来可能扩展的功能 (本期不包含)
- 文件下载
- 文件/文件夹删除、重命名
- 详细的传输队列管理（暂停、取消、重试、速率显示）
- 多文件上传与进度汇总
- 存储桶创建/删除
- 文件预览
- 多账户支持与切换
- 列表视图/网格视图切换
- 排序与筛选

---
**文档状态**: 初稿
**版本**: 0.1
**最后更新**: 2025-05-26 