# v1.0.1 Release Notes

**Release Date**: 2026-02-06

## New Features

### Upload Conflict Detection

Upload files with the same name as existing remote files now triggers a conflict resolution dialog, following macOS Finder's native style.

- **Replace**: Overwrite the existing file with the new one
- **Keep Both**: Automatically rename the new file (e.g., `file (1).txt`)
- **Skip**: Do not upload the conflicting file
- **Apply to All**: Batch-apply the chosen action to all remaining conflicts

The conflict dialog displays file size and modification date for both local and remote files, helping users make informed decisions.

### Cloudflare CDN Cache Purge

Added support for automatic CDN cache purging after file uploads, ensuring public links always serve the latest content.

- **Auto Purge on Upload**: When enabled, CDN cache is automatically purged after overwriting files
- **Manual Purge**: Right-click any file and select "Purge CDN Cache" to manually clear its CDN cache
- **Batch Purge**: Select multiple files and purge their CDN cache at once
- **Configuration**: Account settings now include a dedicated CDN Cache section for Zone ID and API Token

Requires a Cloudflare API Token with `Cache Purge` permission.

### Thumbnail Cache Versioning

Improved thumbnail display when files are overwritten:

- Thumbnail URLs now include a version parameter (`?v=timestamp`) based on file modification time
- In-memory thumbnail cache is automatically invalidated after overwrite uploads
- Ensures the UI always displays the latest version of image thumbnails

## Improvements

- Refactored remote path building logic in `UploadQueueManager` into a shared `buildRemotePath()` method to reduce duplication
- Enlarged the Edit Account sheet height (480 → 560) to accommodate the new CDN settings section
- Cloudflare API Token is securely stored in macOS Keychain, isolated from R2 credentials using a separate service name

## Localization

- Added localization strings for upload conflict dialog (title, actions, file comparison labels)
- Added localization strings for CDN cache settings and purge actions
- Added localization strings for success/error/info messages related to CDN operations

## Files Changed

| File | Change |
|------|--------|
| `UploadConflictSheet.swift` | **New** — Conflict resolution dialog (macOS Finder style) |
| `UploadQueueManager.swift` | Enhanced — Conflict detection, path builder refactor |
| `FileListView.swift` | Enhanced — Conflict sheet integration, CDN purge handler |
| `R2Service.swift` | Enhanced — CDN purge API, thumbnail URL versioning, cache invalidation |
| `R2Account.swift` | Enhanced — Cloudflare Zone ID and auto-purge fields |
| `KeychainService.swift` | Enhanced — Cloudflare API Token CRUD operations |
| `AccountSettingsView.swift` | Enhanced — CDN cache configuration UI |
| `ThumbnailCache.swift` | Enhanced — URL-specific cache invalidation |
| `FileGridItemView.swift` | Enhanced — Versioned thumbnail URL, CDN purge menu item |
| `FileGridView.swift` | Enhanced — CDN purge callback passthrough |
| `FileTableView.swift` | Enhanced — Versioned thumbnail URL, CDN purge menu item |
| `AppStrings.swift` | Enhanced — New localization keys |
| `Localizable.xcstrings` | Enhanced — New localization entries |
